<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ä¸Šæ˜ é¤¨ãƒªã‚¹ãƒˆï¼ˆCSVè‡ªå‹•åæ˜ ãƒ»ã‚¿ãƒ–å¼ï¼‰</title>
<style>
  :root { --bg:#0c0f14; --card:#12161d; --text:#e7ebf3; --muted:#8a93a6; --accent:#4f8cff; --border:#222838; --chip:#1a1f2b; }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,sans-serif}
  header{position:sticky;top:0;z-index:10;background:rgba(12,15,20,.96);backdrop-filter:blur(6px);padding:12px 14px;border-bottom:1px solid var(--border)}
  h1{margin:0;font-size:18px}
  .tabs{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .tab{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:var(--chip);color:var(--text);cursor:pointer;font-size:14px}
  .tab.active{background:var(--accent);border-color:var(--accent);color:#fff}
  .filters{display:grid;gap:8px;padding:10px 14px;border-bottom:1px solid var(--border)}
  .filter-row{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  select,input[type="search"]{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#0f141d;color:var(--text)}
  main{padding:12px 14px}
  .group{margin-top:16px}
  .group h2{font-size:15px;color:var(--muted);margin:0 0 8px}
  .grid{display:grid;gap:10px;grid-template-columns:1fr}
  @media (min-width:720px){.grid{grid-template-columns:1fr 1fr}}
  @media (min-width:1024px){.grid{grid-template-columns:1fr 1fr 1fr}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px;display:grid;gap:6px}
  .title{font-weight:600}
  .meta{color:var(--muted);font-size:13px}
  .badges{display:flex;gap:6px;flex-wrap:wrap}
  .badge{font-size:12px;padding:2px 8px;background:#1a2233;border:1px solid #22304b;border-radius:999px}
  a.btn{display:inline-block;text-decoration:none;color:#fff;background:var(--accent);padding:7px 10px;border-radius:10px;font-size:13px}
  footer{padding:14px;color:var(--muted);font-size:12px;border-top:1px solid var(--border)}
  #csv-debug{position:fixed;left:8px;bottom:8px;max-width:92vw;background:#1f2937;color:#fff;padding:8px 10px;border-radius:8px;font:12px/1.4 system-ui,-apple-system;z-index:9999;opacity:.95;white-space:pre-wrap}
</style>
</head>
<body>

<header>
  <h1>ä¸Šæ˜ é¤¨ãƒªã‚¹ãƒˆï¼ˆCSVè‡ªå‹•åæ˜ ï¼‰</h1>
  <div class="tabs" id="tabs">
    <button type="button" class="tab active" data-tab="all">ALL</button>
    <button type="button" class="tab" data-tab="cinema">Dolby Cinema</button>
    <button type="button" class="tab" data-tab="atmos">Dolby Atmos</button>
    <button type="button" class="tab" data-tab="axk">Dolby AtmosÃ—4K</button>
    <button type="button" class="tab" data-tab="ch71">7.1ch</button>
    <button type="button" class="tab" data-tab="k4">4K</button>
  </div>
</header>

<div class="filters">
  <div class="filter-row">
    <select id="prefSelect"><option value="">ã‚¨ãƒªã‚¢ï¼ˆã™ã¹ã¦ï¼‰</option></select>
    <input id="q" type="search" placeholder="åŠ‡å ´åãƒ»ä½æ‰€ã§æ¤œç´¢â€¦">
  </div>
</div>

<main id="content">
  <div class="group"><h2>èª­ã¿è¾¼ã¿ä¸­â€¦</h2></div>
</main>

<footer>
  â€» ã‚¿ãƒ–ï¼ˆALL / Dolby Cinema / Dolby Atmos / Dolby AtmosÃ—4K / 7.1ch / 4Kï¼‰ã¨ã€ã‚¨ãƒªã‚¢ãƒ»æ¤œç´¢ã§çµã‚Šè¾¼ã¿ã§ãã¾ã™ã€‚
</footer>
<!-- Papa Parseï¼ˆCSVãƒ‘ãƒ¼ã‚µï¼‰ -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" crossorigin="anonymous"></script>

<script>
// â˜… ã‚ãªãŸã®CSVå…¬é–‹URLï¼ˆã“ã®ã¾ã¾ã§OKï¼‰
var SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vShtDnZUCsyJKxq1mUB8Hgid98ngAWYAcgEwhCg2MaV3cqbmyRsEsbr2eyZ8XFdyW00ZdsB2BkJhVuC/pub?gid=1453087675&single=true&output=csv";

// ãƒ‡ãƒãƒƒã‚°è¡¨ç¤ºï¼ˆå·¦ä¸‹ï¼‰
function dbg(msg){
  var el=document.getElementById('csv-debug');
  if(!el){ el=document.createElement('div'); el.id='csv-debug'; el.style.cssText='position:fixed;left:8px;bottom:8px;max-width:92vw;background:#1f2937;color:#fff;padding:8px 10px;border-radius:8px;font:12px/1.4 system-ui,-apple-system;z-index:9999;opacity:.95;white-space:pre-wrap'; document.body.appendChild(el); }
  el.textContent = (typeof msg==='string')? msg : JSON.stringify(msg,null,2);
}

// 47éƒ½é“åºœçœŒ
var PREFS = ["åŒ—æµ·é“","é’æ£®çœŒ","å²©æ‰‹çœŒ","å®®åŸçœŒ","ç§‹ç”°çœŒ","å±±å½¢çœŒ","ç¦å³¶çœŒ","èŒ¨åŸçœŒ","æ ƒæœ¨çœŒ","ç¾¤é¦¬çœŒ","åŸ¼ç‰çœŒ","åƒè‘‰çœŒ","æ±äº¬éƒ½","ç¥å¥ˆå·çœŒ","æ–°æ½ŸçœŒ","å±±æ¢¨çœŒ","é•·é‡çœŒ","å¯Œå±±çœŒ","çŸ³å·çœŒ","ç¦äº•çœŒ","å²é˜œçœŒ","é™å²¡çœŒ","æ„›çŸ¥çœŒ","ä¸‰é‡çœŒ","æ»‹è³€çœŒ","äº¬éƒ½åºœ","å¤§é˜ªåºœ","å…µåº«çœŒ","å¥ˆè‰¯çœŒ","å’Œæ­Œå±±çœŒ","é³¥å–çœŒ","å³¶æ ¹çœŒ","å²¡å±±çœŒ","åºƒå³¶çœŒ","å±±å£çœŒ","å¾³å³¶çœŒ","é¦™å·çœŒ","æ„›åª›çœŒ","é«˜çŸ¥çœŒ","ç¦å²¡çœŒ","ä½è³€çœŒ","é•·å´çœŒ","ç†Šæœ¬çœŒ","å¤§åˆ†çœŒ","å®®å´çœŒ","é¹¿å…å³¶çœŒ","æ²–ç¸„çœŒ"];

// åºƒåŸŸâ†’éƒ½é“åºœçœŒã§ã¯ãªã„ã®ã§ä½æ‰€ã‹ã‚‰æ¨å®šã«åˆ‡ã‚Šæ›¿ãˆã‚‹ãŸã‚ã®åˆ¤å®š
var REGIONS = ["åŒ—æµ·é“","æ±åŒ—","é–¢æ±","åŒ—é™¸","ç”²ä¿¡è¶Š","æ±æµ·","ä¸­éƒ¨","è¿‘ç•¿","é–¢è¥¿","ä¸­å›½","å››å›½","ä¹å·","æ²–ç¸„"];

// ä½æ‰€ã‹ã‚‰éƒ½é“åºœçœŒã‚’æŠ½å‡ºï¼ˆå…ˆé ­ä¸€è‡´ï¼‰
function prefectureFromAddress(addr){
  var s=String(addr||"").replace(/\s|\u3000/g,"").trim();
  if(!s) return "";
  for(var i=0;i<PREFS.length;i++){
    if(s.indexOf(PREFS[i])===0) return PREFS[i];
  }
  // çœç•¥å½¢ã«ã‚‚è»½ãå¯¾å¿œ
  var short={"æ±äº¬":"æ±äº¬éƒ½","å¤§é˜ª":"å¤§é˜ªåºœ","äº¬éƒ½":"äº¬éƒ½åºœ","æ²–ç¸„":"æ²–ç¸„çœŒ"};
  for(var k in short){ if(s.indexOf(short[k])===0 || s.indexOf(k)===0) return short[k]; }
  return "";
}

// æ­£è¦åŒ–ã¨è¡¨ç¤ºå
function normalizePref(p){
  p=String(p||'').replace(/\s|\u3000/g,"").trim();
  if(!p) return '';
  var short={"æ±äº¬":"æ±äº¬éƒ½","å¤§é˜ª":"å¤§é˜ªåºœ","äº¬éƒ½":"äº¬éƒ½åºœ","æ²–ç¸„":"æ²–ç¸„çœŒ","åŒ—æµ·é“":"åŒ—æµ·é“"};
  if(short[p]) return short[p];
  var last=p.charAt(p.length-1);
  if(["éƒ½","é“","åºœ","çœŒ"].indexOf(last)===-1 && p!=="åŒ—æµ·é“") p=p+"çœŒ";
  return p;
}
function displayPref(pref){
  if(!pref) return "";
  if(pref==="åŒ—æµ·é“") return "åŒ—æµ·é“";
  if(pref==="æ±äº¬éƒ½") return "æ±äº¬";
  if(pref==="å¤§é˜ªåºœ") return "å¤§é˜ª";
  if(pref==="äº¬éƒ½åºœ") return "äº¬éƒ½";
  var last=pref.charAt(pref.length-1);
  if(["éƒ½","é“","åºœ","çœŒ"].indexOf(last)!==-1) return pref.slice(0,-1);
  return pref;
}

// åˆ—åä¸€è‡´ï¼ˆã‚†ã‚‰ãå¯¾å¿œï¼‰
function nHead(s){return String(s||'').replace(/\u3000/g,' ').trim().toLowerCase();}
function findIdx(h, aliases){
  var H=[]; for(var i=0;i<h.length;i++){H.push(nHead(h[i]));}
  for(var j=0;j<aliases.length;j++){ var key=nHead(aliases[j]); var idx=H.indexOf(key); if(idx!==-1) return idx; }
  return -1;
}
var ALIAS={
  pref:["ã‚¨ãƒªã‚¢","éƒ½é“åºœçœŒ","éƒ½é“åºœçœŒå","çœŒå","é“åºœçœŒ","åœ°åŸŸ"],
  name:["åŠ‡å ´å","æ˜ ç”»é¤¨","æ˜ ç”»é¤¨å","ã‚·ã‚¢ã‚¿ãƒ¼","é¤¨å","åç§°","åŠ‡å ´"],
  addr:["ä½æ‰€","æ‰€åœ¨åœ°","ä½æ‰€1","ä½æ‰€_å…¨æ–‡","address","æ‰€åœ¨åœ°ä½æ‰€"],
  url:["URL","url","ãƒªãƒ³ã‚¯","å…¬å¼","å…¬å¼ã‚µã‚¤ãƒˆ","ã‚µã‚¤ãƒˆURL","å…¬å¼ã‚µã‚¤ãƒˆURL"],
  atmos:["Dolby Atmos","Atmos","ãƒ‰ãƒ«ãƒ“ãƒ¼ã‚¢ãƒˆãƒ¢ã‚¹","ã‚¢ãƒˆãƒ¢ã‚¹","Atmosæ•°","ã‚¢ãƒˆãƒ¢ã‚¹æ•°"],
  ch71:["7.1ch","7.1 ch","7.1CH","7_1ch","7-1ch"],
  k4:["4K","4ï½‹","ï¼”ï¼«","4k","4Kå¯¾å¿œ"],
  other:["other","å‚™è€ƒ","ãƒ¡ãƒ¢","æ³¨è¨˜","å½¢å¼"],
  seats:["åº§å¸­æ•°","å¸­æ•°","ã‚·ãƒ¼ãƒˆæ•°","ã‚­ãƒ£ãƒ‘","åå®¹äººæ•°","å®šå“¡"]
  cinema:["DolbyCinema","Dolby Cinema","ãƒ‰ãƒ«ãƒ“ãƒ¼ã‚·ãƒãƒ","DC","ï¼¤ï¼£"],
};

function buildDataFromRows(header, rows){
  function idx(aliases){ return findIdx(header, aliases); }
  var iPref=idx(ALIAS.pref), iName=idx(ALIAS.name), iAddr=idx(ALIAS.addr),
      iURL=idx(ALIAS.url), iAt=idx(ALIAS.atmos), i71=idx(ALIAS.ch71),
      i4K=idx(ALIAS.k4), iOther=idx(ALIAS.other), iSeats=idx(ALIAS.seats);

  var data=[], dynamicPrefOrder=[], seenPrefMap={};
  function addPrefOrder(pn){
    if(pn in seenPrefMap) return;
    seenPrefMap[pn]=true; dynamicPrefOrder.push(pn);
  }

  for(var r=0;r<rows.length;r++){
    var row=rows[r]||[];

    // 1) ã‚¨ãƒªã‚¢åˆ—ï¼ˆprefRawï¼‰ã‚’èª­ã‚€
    var prefRaw = (iPref>-1? String(row[iPref]||"").trim() : "");
    var prefNorm = "";

    // 2) ã‚¨ãƒªã‚¢ãŒåºƒåŸŸåãªã‚‰ prefRaw ã¯æ¨ã¦ã¦ä½æ‰€ã‹ã‚‰æ¨å®š
    var isRegion = REGIONS.indexOf(prefRaw.replace(/\s|\u3000/g,"")) !== -1;

    if(!prefRaw || isRegion){
      var guess = prefectureFromAddress(iAddr>-1? row[iAddr] : "");
      prefNorm = normalizePref(guess);
    }else{
      prefNorm = normalizePref(prefRaw);
      // ã‚¨ãƒªã‚¢ãŒã€Œé–¢æ±ã€ã€Œæ±åŒ—ã€ãªã©ã®å¯èƒ½æ€§ã«ã‚‚ã†ä¸€æ®µå¯¾å¿œï¼šéƒ½é“åºœçœŒã«ãƒãƒƒãƒã—ãªã„ãªã‚‰ä½æ‰€ã§å†æ¨å®š
      if(PREFS.indexOf(prefNorm)===-1){
        var guess2 = prefectureFromAddress(iAddr>-1? row[iAddr] : "");
        if(guess2) prefNorm = normalizePref(guess2);
      }
    }

    // ãƒ‡ãƒ¼ã‚¿è¡Œä½œæˆ
    var rec = {
      prefNorm: prefNorm,                   // ç©ºã®ã¾ã¾ã‚‚è¨±å®¹ï¼ˆã‚ã¨ã§ã€Œï¼ˆã‚¨ãƒªã‚¢ä¸æ˜ï¼‰ã€ã«å…¥ã‚Œã‚‹ï¼‰
      prefDisp: prefNorm ? displayPref(prefNorm) : "ï¼ˆã‚¨ãƒªã‚¢ä¸æ˜ï¼‰",
      theater:  iName>-1?  String(row[iName]||"").trim():"",
      address:  iAddr>-1?  String(row[iAddr]||"").trim():"",
      url:      iURL>-1?   String(row[iURL]||"").trim():"",
      atmos:    iAt>-1?    String(row[iAt]||"").trim():"",
      ch71:     i71>-1?    String(row[i71]||"").trim():"",
      k4:       i4K>-1?    String(row[i4K]||"").trim():"",
      other:    iOther>-1? String(row[iOther]||"").trim():"",
      seats:    iSeats>-1? String(row[iSeats]||"").trim():""
    };
    data.push(rec);

    // ã‚°ãƒ«ãƒ¼ãƒ—é †ã®æ§‹ç¯‰ï¼šã¾ãšã¯ 47éƒ½é“åºœçœŒé †ã€ãã®å¾Œã«æœªçŸ¥ã®ã‚‚ã®
    if(rec.prefNorm){
      if(PREFS.indexOf(rec.prefNorm)!==-1){
        // æ—¢çŸ¥ï¼šPREFSé †ã¯ render å‰ã«ä¸¦ã¹ã‚‹ã®ã§ã“ã“ã§ã¯ãƒ•ãƒ©ã‚°ã ã‘
        seenPrefMap[rec.prefNorm]=true;
      }else{
        // æœªçŸ¥ï¼ˆä¾‹ï¼šçœŒåãŒå¤‰å‰‡ã§ã‚‚ï¼‰â†’å‹•çš„ã«è¿½åŠ 
        addPrefOrder(rec.prefNorm);
      }
    }
  }

  // è¡¨ç¤ºç”¨ã®éƒ½é“åºœçœŒãƒªã‚¹ãƒˆï¼š
  // 1) å‡ºç¾ã—ãŸ 47éƒ½é“åºœçœŒï¼ˆPREFSé †ï¼‰
  var prefects=[];
  for(var i=0;i<PREFS.length;i++){
    if(seenPrefMap[PREFS[i]]) prefects.push({norm:PREFS[i], disp:displayPref(PREFS[i])});
  }
  // 2) 47ä»¥å¤–ã®è¡¨è¨˜ï¼ˆã‚ã‚Œã°ï¼‰ã‚’å¾Œã‚ã¸
  for(var j=0;j<dynamicPrefOrder.length;j++){
    var pn = dynamicPrefOrder[j];
    if(PREFS.indexOf(pn)===-1) prefects.push({norm:pn, disp:displayPref(pn)});
  }
  // 3) ã‚¨ãƒªã‚¢ä¸æ˜ãŒã‚ã‚‹ãªã‚‰æœ€å¾Œã«è¡¨ç¤º
  var hasUnknown=false; for(var k=0;k<data.length;k++){ if(!data[k].prefNorm){ hasUnknown=true; break; } }
  if(hasUnknown) prefects.push({norm:"", disp:"ï¼ˆã‚¨ãƒªã‚¢ä¸æ˜ï¼‰"});

  // è¨ºæ–­
  dbg("æ¤œå‡ºãƒ˜ãƒƒãƒ€ãƒ¼: "
    + "\n  ã‚¨ãƒªã‚¢: "+(iPref>-1? header[iPref]:"(æœªæ¤œå‡º)")
    + "\n  ä½æ‰€  : "+(iAddr>-1? header[iAddr]:"(æœªæ¤œå‡º)")
    + "\n  åŠ‡å ´å: "+(iName>-1? header[iName]:"(æœªæ¤œå‡º)")
    + "\næŠ½å‡ºéƒ½é“åºœçœŒã®ä¾‹: "
    + (data.slice(0,5).map(function(d){return (d.prefNorm||"ä¸æ˜")+": "+(d.theater||"");}).join("\n  - "))
  );

  return {data:data, prefects:prefects};
}

// CSVèª­ã¿è¾¼ã¿
(function(){
  Papa.parse(SHEET_CSV_URL,{
    download:true, header:false, skipEmptyLines:true,
    complete:function(res){
      var rows=res.data||[]; if(!rows.length){ dbg("CSVãŒç©ºã§ã™"); return; }
      var header=rows[0], body=rows.slice(1);
      var built=buildDataFromRows(header, body);
      window.data=built.data; window.prefects=built.prefects;
      if(typeof initUI==="function"){ initUI(); render(); }
    },
    error:function(err){ console.error(err); dbg("CSVèª­è¾¼ã‚¨ãƒ©ãƒ¼ï¼šURL/å…¬é–‹è¨­å®šã‚’ç¢ºèª"); }
  });
})();
</script>


<!-- ===== è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ï¼ˆUIï¼‰ ===== -->
<script>
  var STATE = { tab:"all", pref:"", q:"" };

  function initUI(){
    // ã‚¿ãƒ–
    var tabs=document.getElementById("tabs");
    tabs.onclick=function(e){
      var t=e.target; if(!t || t.className.indexOf("tab")===-1) return;
      var all=tabs.getElementsByClassName("tab");
      for(var i=0;i<all.length;i++){ all[i].className=all[i].className.replace(" active",""); }
      if(t.className.indexOf("active")===-1) t.className+=" active";
      STATE.tab=t.getAttribute("data-tab");
      render();
    };
    // ã‚¨ãƒªã‚¢ï¼ˆéƒ½é“åºœçœŒï¼‰ã‚»ãƒ¬ã‚¯ãƒˆ
    var sel=document.getElementById("prefSelect");
    for(var i=0;i<window.prefects.length;i++){
      var o=document.createElement("option");
      o.value=window.prefects[i].norm; o.textContent=window.prefects[i].disp; sel.appendChild(o);
    }
    sel.onchange=function(){ STATE.pref=this.value; render(); };
    // æ¤œç´¢
    var q=document.getElementById("q");
    q.oninput=function(){ STATE.q=this.value.replace(/^\s+|\s+$/g,""); render(); };
  }

  function nz(v){ return v && String(v).replace(/\s+/g,"")!==""; }
  function matchTab(rec){
    if(STATE.tab==="all") return true;
    if(STATE.tab==="cinema") return rec.other && rec.other.indexOf("Dolby Cinema")!==-1;
    if(STATE.tab==="atmos")  return nz(rec.atmos);
    if(STATE.tab==="axk")    return nz(rec.atmos) && nz(rec.k4);
    if(STATE.tab==="ch71")   return nz(rec.ch71);
    if(STATE.tab==="k4")     return nz(rec.k4);
    return true;
  }
  function matchFilters(rec){
    if(STATE.pref !== "" && rec.prefNorm !== STATE.pref) return false;
    if(STATE.q){
      var hay=(rec.theater+" "+rec.address+" "+(rec.prefDisp||"")).toLowerCase();
      if(hay.indexOf(STATE.q.toLowerCase())===-1) return false;
    }
    return true;
  }
  function badgeRow(rec){
    var b=[]; 
    if(nz(rec.atmos)) b.push("ğŸ¬ Dolby Atmosï¼š"+rec.atmos);
    if(nz(rec.k4))    b.push("âœ¨ 4K");
    if(nz(rec.ch71))  b.push("ğŸ”Š 7.1ch");
    if(rec.other && rec.other.indexOf("Dolby Cinema")!==-1) b.push("ğŸ¥ Dolby Cinema");
    if(!b.length) return "";
    var h='<div class="badges">'; for(var i=0;i<b.length;i++){ h+='<span class="badge">'+b[i]+'</span>'; } h+='</div>'; return h;
  }
  function seatsLine(rec){
    var s=(rec.seats && String(rec.seats).trim()!=="")? rec.seats : "â€”";
    if(rec.atmos && String(rec.atmos).trim()!==""){ return 'ğŸ¬ Dolby Atmosï¼š'+rec.atmos+'ï¼ˆğŸ’º åº§å¸­æ•°ï¼š'+s+'ï¼‰'; }
    return 'ğŸ’º åº§å¸­æ•°ï¼š'+s;
  }
  function card(rec){
    var link=rec.url? '<a class="btn" href="'+rec.url+'" target="_blank" rel="noopener">å…¬å¼ã‚µã‚¤ãƒˆ</a>' : '';
    return '<div class="card">'
         +   '<div class="title">'+(rec.theater||"(åŠ‡å ´åä¸æ˜)")+'</div>'
         +   '<div class="meta">ğŸ“ '+(rec.address||"")+'</div>'
         +   '<div class="meta">'+seatsLine(rec)+'</div>'
         +   badgeRow(rec)
         +   link
         + '</div>';
  }
  function render(){
    if(!window.data){ return; }
    var recs=[]; for(var i=0;i<window.data.length;i++){ var r=window.data[i]; if(matchTab(r)&&matchFilters(r)) recs.push(r); }
    var groups={}; for(var j=0;j<recs.length;j++){ var k=(r=recs[j]).prefNorm||""; if(!groups[k]) groups[k]=[]; groups[k].push(r); }

    var content=document.getElementById("content"); var html="";
    // æ—¢çŸ¥ã®éƒ½é“åºœçœŒ â†’ ï¼ˆã‚¨ãƒªã‚¢ä¸æ˜ï¼‰ã®é †
    var shownUnknown=false;
    for(var p=0;p<window.prefects.length;p++){
      var key=window.prefects[p].norm; var arr=groups[key]; if(!arr||!arr.length) continue;
      html+='<section class="group"><h2>'+window.prefects[p].disp+'</h2><div class="grid">';
      for(var m=0;m<arr.length;m++){ html+=card(arr[m]); }
      html+='</div></section>';
    }
    if(groups[""] && groups[""].length){
      shownUnknown=true;
      html+='<section class="group"><h2>ï¼ˆã‚¨ãƒªã‚¢ä¸æ˜ï¼‰</h2><div class="grid">';
      var arrU=groups[""]; for(var u=0;u<arrU.length;u++){ html+=card(arrU[u]); }
      html+='</div></section>';
    }
    if(!html){ html='<div class="group"><h2>è©²å½“ãªã—</h2><div class="meta">ã‚¿ãƒ–ãƒ»ã‚¨ãƒªã‚¢ãƒ»æ¤œç´¢ã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚</div></div>'; }
    content.innerHTML=html;
  }
</script>

</body>
</html>
